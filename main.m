
clear all
clc

A = diag([10, 5, 1, -2, -10]);  % autovalori noti
v = randn(5,1);
v = v / norm(v);
m = 4; 
k = 2;
[V,it] = Krylov_Schur(v,A,m,k);
Hsq = V'*A*V; %Matrice quadrata di Heissemberg
th = eig(Hsq); %problema di Ritz e autovalori approssimati

%%
clear all
clc
itz = 1000;

A = [0.0733616900804668	0.0364255155254801	0.499648777847273	0.246069567106098	0.617850587139279	0.698199766179566	0.970372902013312	0.898376325005631	0.0685823485554556	0.600838938434792
     0.822326222185306	0.326244573060312	0.615288242215057	0.581491252368133	0.0702135239869584	0.733742133263281	0.123860507146820	0.728444033957786	0.299400386560865	0.112462378383286
     0.722902973268465	0.973013623892820	0.583132968088648	0.937676879074775	0.0692789725680013	0.650530624454913	0.467410026774460	0.406830134654488	0.591583534156367	0.515765653195914
     0.925858038017486	0.365032625305747	0.698253926627414	0.0477872923850662	0.136007388620090	0.516270565774129	0.656694003304474	0.938315840253697	0.203299145356336	0.837840690870234
     0.492638598461781	0.309149618895917	0.0293323427543620	0.0539776591702386	0.788891319657009	0.326388135088882	0.290185566632867	0.255427454937803	0.635883198886887	0.920790107998705
     0.654882898449669	0.120912384580628	0.527882687738647	0.0206180341199909	0.0923984579238296	0.661776196778501	0.754536639716295	0.533163240608823	0.798370257830259	0.498227929455356
     0.890123477961687	0.915765704040790	0.0320728464199854	0.681478514196212	0.237868792007306	0.117565484621756	0.558118051358972	0.954754870376370	0.501701052364218	0.277611122264388
     0.538525574469021	0.135478205681502	0.827142322836315	0.598628526633235	0.243647912616785	0.147817414181606	0.427792595548456	0.267747536440096	0.650812135949142	0.652519960748294
     0.282205164558222	0.332117891828341	0.339986206482169	0.114030034515656	0.104822212658895	0.0197646637288170	0.267194057274200	0.250084620589589	0.795954985556127	0.917298803800668
     0.975957517879964	0.897479892399884	0.846710958880530	0.796245350725845	0.858352760228758	0.964291730299559	0.753736074133061	0.927672720239348	0.233373768071567	0.509839453514736];

v =  [-0.318776518738141
      0.0639759007484543
      0.415465966431780
      0.412865343101648
     -0.398050495567505
      0.501360402094415
      0.204972149846485
      0.0704301790141458
     -0.0698817501137223
     -0.299257336233650];

v = v / norm(v);
m = 7; 
k = 2;
[V,res] = Krylov_Schur(v,A,m,k,itz);
it = (1:itz);
figure();
leg = cell(1, k); 

for i = 1:k
    plot(it, res(1:itz,i));
    hold on
    leg{i} = sprintf('res eig nÂ° %d', i);
end

legend(leg);
hold off;

Hsq = V'*A*V; %Matrice quadrata di Heissemberg finale
th = eig(Hsq); %problema di Ritz e autovalori approssimati
